<VirtualHost *:80>
    ServerName ${MOODLE_SERVER_NAME}
    ServerAlias ${MOODLE_SERVER_NAME}
    Redirect permanent / ${MOODLE_APP_URL}/
</VirtualHost>

<VirtualHost *:443>
    ServerName ${MOODLE_SERVER_NAME}
    ServerAlias ${MOODLE_SERVER_NAME}
    DocumentRoot ${MOODLE_DOCKER_WWWROOT}

    SSLEngine on
    SSLCertificateFile /var/lib/${MOODLE_APP_NAME}/ssl/wildcard-ssl.crt
    SSLCertificateKeyFile /var/lib/${MOODLE_APP_NAME}/ssl/wildcard-ssl.key

    <Directory ${MOODLE_DOCKER_WWWROOT}>
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/${MOODLE_APP_NAME}_error.log
    CustomLog ${APACHE_LOG_DIR}/${MOODLE_APP_NAME}_access.log combined
</VirtualHost>
